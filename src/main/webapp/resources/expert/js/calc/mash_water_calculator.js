function MashWaterCalculator(t){for(var i in t)this[i]=t[i];this.metric?(this.thermodynamicConstant=.41,this.mashOutTemp=75.5,this.volumeUnit="L",this.weightUnit="kg",this.tempUnit="&deg;C",this.grainTemp=20):(this.thermodynamicConstant=.2,this.mashOutTemp=168,this.volumeUnit="gal",this.weightUnit="lb",this.tempUnit="&deg;F",this.grainTemp=68),this.strikeStep=function(t,i){return"Strike grains with {mashWater} {volumeUnit} of water at {strikeTemp} {tempUnit}.".supplant({mashWater:t.round(2),volumeUnit:this.volumeUnit,strikeTemp:i.round(1),tempUnit:this.tempUnit})},this.mashRestStep=function(t,i){return"Mash at {mashTemp} {tempUnit} for {mashTime} min.".supplant({mashTemp:t.round(1),tempUnit:this.tempUnit,mashTime:i})},this.vorlaufAndLauterStep=function(t,i){return"Vorlauf and lauter {runnings} {volumeUnit} in your {which} runnings.".supplant({runnings:t.round(2),volumeUnit:this.volumeUnit,which:i})},this.spargeStep=function(t,i){return"Add {spargeWater} {volumeUnit} of sparge water at {spargeTemp} {tempUnit}.".supplant({spargeWater:t.round(2),spargeTemp:i,volumeUnit:this.volumeUnit,tempUnit:this.tempUnit})},this.mashOutStep=function(t,i){return"Mash out with {mashOut} {volumeUnit} of water at {mashOutTemp} {tempUnit}.".supplant({mashOut:t.round(2),volumeUnit:this.volumeUnit,mashOutTemp:i,tempUnit:this.tempUnit})},this.combinedRunningsStep=function(t){return"Your combined runnings should be {combinedRunnings} {volumeUnit}.".supplant({combinedRunnings:t.round(2),volumeUnit:this.volumeUnit})},this.rinseSpargeStep=function(t){return"Rinse the grain in {spargeWaterVolume} {volumeUnit} sparge water at {spargeTemp} {tempUnit}.".supplant({spargeWaterVolume:t.round(2),spargeTemp:this.mashOutTemp,volumeUnit:this.volumeUnit,tempUnit:this.tempUnit})},this.drainBagStep=function(t){return"Drain the grain bag into the mash water to make {combinedRunningsVolume} {volumeUnit} wort.".supplant({combinedRunningsVolume:t.round(2),volumeUnit:this.volumeUnit})},this.drainBagAndCombineRunningsStep=function(t){return"Drain the grain bag and combine the mash and sparge water to make {combinedRunningsVolume} {volumeUnit} wort.".supplant({combinedRunningsVolume:t.round(2),volumeUnit:this.volumeUnit})},this.strikeWaterTemp=function(t,i,s){if(this.metric)var e=.119826427*t*4;else var e=4*t;return this.thermodynamicConstant/e*(i-s)+i},this.mashInfusionTemp=function(t,i,s,e){return(e-s)*(this.thermodynamicConstant*i+t)/(this.boilingTemp-e)/4},this.mashOutWaterVolume=function(t,i,s){return this.mashInfusionTemp(t,i,s,this.mashOutTemp)},this.arrayToList=function(t){return t.map(function(t){return"<li>"+t+"</li>"}).join("\n")},this.singleInfusionBatchSparge=function(){var t=this.grainWeight*this.mashThickness+this.lauterDeadspace,i=t/this.grainWeight,s=this.boilVolume-t+this.grainWeight*this.grainAbsorptionFactor+this.lauterDeadspace,e=t-this.grainWeight*this.grainAbsorptionFactor-this.lauterDeadspace,n=s,h=e+n,a=this.strikeWaterTemp(i,this.mashTemp,this.grainTemp);return this.arrayToList([this.strikeStep(t,a),this.mashRestStep(this.mashTemp,this.mashTime),this.vorlaufAndLauterStep(e,"first"),this.spargeStep(s,this.mashOutTemp),this.vorlaufAndLauterStep(n,"second"),this.combinedRunningsStep(h)])},this.singleInfusionMashOutBatchSparge=function(){var t=this.grainWeight*this.mashThickness+this.lauterDeadspace,i=t/this.grainWeight,s=this.mashOutWaterVolume(t,this.grainWeight,this.mashTemp),e=t+s-this.grainWeight*this.grainAbsorptionFactor-this.lauterDeadspace,n=this.boilVolume-e,h=n,a=e+h,r=this.strikeWaterTemp(i,this.mashTemp,this.grainTemp);return this.arrayToList([this.strikeStep(t,r),this.mashRestStep(this.mashTemp,this.mashTime),this.mashOutStep(s,this.boilingTemp),this.vorlaufAndLauterStep(e,"first"),this.spargeStep(n,this.mashOutTemp),this.vorlaufAndLauterStep(h,"second"),this.combinedRunningsStep(a)])},this.singleInfusionMashOutBatchSpargeEqualRunnings=function(){var t=this.grainWeight*this.mashThickness,i=this.boilVolume/2-(t-this.grainWeight*this.grainAbsorptionFactor-this.lauterDeadspace),s=this.boilVolume/2,e=t+i-this.grainWeight*this.grainAbsorptionFactor-this.lauterDeadspace,n=s,h=e+n,a=this.strikeWaterTemp(this.mashThickness,this.mashTemp,this.grainTemp);return this.arrayToList([this.strikeStep(t,a),this.mashRestStep(this.mashTemp,this.mashTime),this.mashOutStep(i,this.mashOutTemp),this.vorlaufAndLauterStep(e,"first"),this.spargeStep(s,this.mashOutTemp),this.vorlaufAndLauterStep(n,"second"),this.combinedRunningsStep(h)])},this.singleInfusionTwoEqualBatchSparges=function(){var t=this.grainWeight*this.mashThickness+this.lauterDeadspace,i=t/this.grainWeight,s=t-this.grainWeight*this.grainAbsorptionFactor-this.lauterDeadspace,e=(this.boilVolume-s)/2,n=e,h=e,a=s+n+h,r=this.strikeWaterTemp(i,this.mashTemp,this.grainTemp);return this.arrayToList([this.strikeStep(t,r),this.mashRestStep(this.mashTemp,this.mashTime),this.vorlaufAndLauterStep(s,"first"),this.spargeStep(e,this.mashOutTemp),this.vorlaufAndLauterStep(n,"second"),this.spargeStep(e,this.mashOutTemp),this.vorlaufAndLauterStep(h,"third"),this.combinedRunningsStep(a)])},this.singleInfusionNoSpargeBiab=function(){var t=this.boilVolume+this.grainWeight*this.grainAbsorptionFactor,i=t/this.grainWeight,s=t-this.grainWeight*this.grainAbsorptionFactor,e=this.strikeWaterTemp(i,this.mashTemp,this.grainTemp);return this.arrayToList([this.strikeStep(t,e),this.mashRestStep(this.mashTemp,this.mashTime),this.drainBagStep(s)])},this.singleInfusionSpargeRinseBiab=function(){var t=this.grainWeight*this.mashThickness,i=this.strikeWaterTemp(this.mashThickness,this.mashTemp,this.grainTemp),s=this.boilVolume-t+this.grainWeight*this.grainAbsorptionFactor,e=t+s-this.grainWeight*this.grainAbsorptionFactor;return this.arrayToList([this.strikeStep(t,i),this.mashRestStep(this.mashTemp,this.mashTime),this.rinseSpargeStep(s),this.drainBagAndCombineRunningsStep(e)])}}